<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mapa de Compras - Admin</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body { margin: 0; padding: 0; padding-top: 70px; font-family: 'Segoe UI', sans-serif; }

    /* BARRA ADMIN */
    .admin-bar {
      position: fixed; top: 0; left: 0; width: 100%; background: #000; color: #fff;
      padding: 15px 20px; z-index: 2000; display: flex; align-items: center;
      font-weight: 700; text-transform: uppercase; box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      gap: 15px;
    }

    /* FLECHA IZQUIERDA */
    .back-btn-header {
      background: transparent; color: #fff; border: none; font-size: 1.4rem;
      cursor: pointer; padding: 8px; border-radius: 50%; transition: 0.2s;
    }
    .back-btn-header:hover { background: rgba(255,255,255,0.1); }

    /* TÍTULO */
    .title { flex: 1; }

    /* BOTÓN ESTADÍSTICAS VERTICAL - BARRAS CRECIENTES DE ARRIBA A ABAJO */
    .stats-bars-btn {
      background: transparent; border: none; display: flex; flex-direction: column;
      justify-content: center; align-items: center; gap: 2px; cursor: pointer;
      padding: 10px 8px; border-radius: 8px; transition: 0.2s; width: 36px;
    }
    .stats-bars-btn:hover { background: rgba(255,255,255,0.1); }

    .bar {
      background: #fff; width: 4px; border-radius: 2px; transition: 0.2s;
    }
    .bar-1 { height: 0.5vh; }   /* 0.005 → 0.5vh */
    .bar-2 { height: 0.7vh; }   /* 0.007 → 0.7vh */
    .bar-3 { height: 1.0vh; }   /* 0.010 → 1.0vh */

    .admin-btn {
      background: #fff; color: #000; padding: 8px 16px; border-radius: 8px; font-weight: 700;
      cursor: pointer; font-size: 0.9rem; border: none; transition: 0.2s;
    }
    .admin-btn:hover { background: #f0f0f0; }

    /* ... resto del CSS igual (leyenda, panel, etc.) ... */
    .legend { /* sin cambios */ }
    .stats-panel { /* sin cambios */ }
  </style>
</head>
<body>

  <!-- BARRA SUPERIOR -->
  <div class="admin-bar">
    <button class="back-btn-header" id="backBtnHeader" title="Volver al Panel">←</button>
    <div class="title">MAPA DE COMPRAS</div>

    <!-- BOTÓN ESTADÍSTICAS VERTICAL -->
    <button class="stats-bars-btn" id="toggleBothBtn" title="Mostrar Paneles">
      <div class="bar bar-1"></div>
      <div class="bar bar-2"></div>
      <div class="bar bar-3"></div>
    </button>

    <button class="admin-btn" id="logoutBtn">Cerrar Sesión</button>
  </div>

  <!-- MAPA + LEYENDA + PANEL (sin cambios) -->
  <div class="map-container">
    <div id="map"></div>

    <div class="legend" id="legendPanel">
      <h4>
        Leyenda
        <button class="close-legend" id="closeLegendBtn">×</button>
      </h4>
      <!-- ítems de leyenda -->
    </div>

    <div class="stats-panel" id="statsPanel">
      <h3>
        Resumen
        <button class="close-stats" id="closeStatsBtn">×</button>
      </h3>
      <!-- estadísticas -->
    </div>
  </div>

  <!-- SCRIPTS (sin cambios) -->
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // === FIREBASE, MAPA, DATOS (sin cambios) ===

    // === ELEMENTOS ===
    const statsPanel = document.getElementById('statsPanel');
    const legendPanel = document.getElementById('legendPanel');
    const toggleBothBtn = document.getElementById('toggleBothBtn');
    const closeStatsBtn = document.getElementById('closeStatsBtn');
    const closeLegendBtn = document.getElementById('closeLegendBtn');

    // === MOSTRAR/OCULTAR AMBOS ===
    toggleBothBtn.addEventListener('click', () => {
      const bothHidden = statsPanel.classList.contains('hidden') && legendPanel.classList.contains('hidden');
      const bothVisible = !statsPanel.classList.contains('hidden') && !legendPanel.classList.contains('hidden');

      if (bothHidden || !bothVisible) {
        statsPanel.classList.remove('hidden');
        legendPanel.classList.remove('hidden');
      } else {
        statsPanel.classList.add('hidden');
        legendPanel.classList.add('hidden');
      }
    });

    // === CERRAR INDIVIDUAL ===
    closeStatsBtn.addEventListener('click', () => statsPanel.classList.add('hidden'));
    closeLegendBtn.addEventListener('click', () => legendPanel.classList.add('hidden'));

    // === VOLVER Y CERRAR SESIÓN ===
    document.getElementById('backBtnHeader').onclick = () => window.location.href = 'admin.html';
    document.getElementById('logoutBtn').onclick = () => {
      localStorage.removeItem('isAdmin');
      localStorage.removeItem('loggedIn');
      window.location.href = 'index.html';
    };
  </script>
</body>
</html>
